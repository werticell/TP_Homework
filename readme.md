# Tech Prog Homework

Задания с курса "Технологии программирования" ФПМИ ПМИ 2019-2020.


## Задание 1. backup директории

Необходимо создать bash-скрипт, который будет бэкапить все файлы с кодом определенного расширения, которые лежат не выше определенной директории.
Алгоритм действия:
1. Скрипт должен находить все файлы с определенным расширением и
копировать их содержимое в папку (скрипт должен создавать папку)
2. Скрипт должен создавать архив расширением .tar.gz, который содержит все
файлы и папки, созданные в ходе 1 алгоритма.
3. Скрипт должен ничего писать, кроме ​done​по завершению работы.

#### Параметры запуска скрипта
Скрипт будет запускаться со следующими параметрами

           ./run.sh <путь к директории> <расширение> <название папки для бэкапа> <имя архива с бэкапом>
Пример:

           ./run.sh ~/repo cpp backup backup.tar.gz
           
           
## Задание 2. Cистемы сборки

Необходимо создать структуру проекта в CMake, поддерживающую следующие возможности
Алгоритм действия:
1. Исходный код лежит в трех папках A, B, C.
2. В папке А лежит скрипт на питоне, preparing.py, который генерирует хедер
index.h.
3. В папке B лежит библиотека со своим собственным CMakeLists.txt, главный
хедер - lib.h.
4. (Простой путь) В папке С лежит два файла main.h и main.cpp, в main.h есть
строчка #include "A/index.h" и строчка "include "B/lib.h".
5. (Сложный путь) В папке C помимо файлов из пункта 4 лежит файл main_test.cpp
и некоторые другие файлы, которые запускают сборку тестов через [google test](https://ru.wikipedia.org/wiki/Google_C%2B%2B_Testing_Framework). В файле main_test.cpp должен быть запуск тестов, а в другом cpp-файле, который собирается в один executable - должны быть реализованы 2 теста: один проверяет, что A/index.h делает корректные вещи, второй проверяет правильность реализации библиотеки.
6. После сборки проекта:
   - (Простой путь) должна быть создана папка bin, в которой должен быть
лежать исполняемый файл C с главной точкой входа main.cpp
   - должна быть создана папка lib, в которой должны лежать собранные
динамические библиотеки.
   - (Сложный путь) в папке bin дополнительно должен лежать исполняемый
файл CTest с запуском тестов, полученный после сборки C/main_test.cpp с исходными файлами, содержащие тесты.


#### Параметры запуска сборки проекта
Один из вариантов сборки проекта будет запускаться следующими командами:

        mkdir 
        build 
        cd build 
        cmake .. 
        make
При этом проверяющая система может в каком-угодно месте создать папку для сборки, используйте переменную для сборки проекта.

## Задание 3. Кросс-компиляция
Есть имеющийся проект на CMake, необходимо сделать этот проект cross-компилируемым!

 #### Предыстория
Представим себе, что у нас есть небольшая плата, которая имеет arm-архитектуру, но собирать сложные библиотеки на плате - плохая затея. Поэтому на машину (ноутбук, персональный ноутбук) ставится Toolchain для сборки и Sysroot для эмуляции arm-архитектуры.


Вашей целью является адаптировать имеющийся CMake-проект под сборку для arm-архитектуры.

#### Сценарий исполнения:
Собирается проект с указанием пути к Toolchain
Готовится набор библиотек/хедеров/исполняемых файлов для переноса на машину под arm-архитектурой
Файлы переносятся на плату (делается проверяющей системой автоматически)
На плате собирается еще один проект, который подключает хедеры/библиотеки из предыдущего пункта

### Алгоритм действия
1. Клонируйте [репозиторий](https://github.com/akhtyamovpavel/TechProgSimpleLibrary)(он собирается под Linux и Mac спокойно)
В нем есть две цели: Main и MainLib, которые необходимо и запустить под ARM архитектурой!
2. Скачайте тулчейн по ссылке [отсюда](https://releases.linaro.org/components/toolchain/binaries/latest-7/arm-linux-gnueabihf/gcc-linaro-7.5.0-2019.12-i686_arm-linux-gnueabihf.tar.xz) .
3. Научитесь добавлять скачанный компилятор для сборки CMake (см. раздел “Параметры запуска сборки проекта”)
4. Скачайте [sysroot](http://releases.linaro.org/components/toolchain/binaries/7.5-2019.12/armv8l-linux-gnueabihf/sysroot-glibc-linaro-2.25-2019.12-armv8l-linux-gnueabihf.tar.xz) для проверки проекта. 
5. Скачайте QEMU для виртуализации запуска программ (можно подставить через apt-get)
Пользователям mac-а советуется поставить виртуальную машину для выполнения заданий
6. Для тестирования задания можно использовать команду: qemu-arm -L <path/to/sysroot> <path/to/executable>
7. Однако если пункт 6 у вас работает, то это не значит, что будет работать в любом месте и на любой архитектуре. Для дистрибуции пакетов необходимо выполнять команду make install, поддержку которой вам необходимо будет реализовать. Тестирующая система запускает на другой машине Main с определенным путем, как именно путь устроен - можно посмотреть во втором задании
8. После выполнения команды make install вы обнаружите, что у вас не хватает путей к библиотекам, необходимо исправить эту проблему: ключевое слово для гугла - rpath. Тестирующая система запускает на другой машине (с ARM-архитектурой) файл MainLib с определенным путем, куда именно должен быть положен MainLib - можно посмотреть в оригинальном CMakeLists.txt или во втором задании
9. Если вы прошли пункт 8 (за это вы получите 0.3 балла), то необходимо правильно прописать опции установки. На машине с arm-архитектурой будет производиться сборка cmake-проекта, который знает о том, что файлы для сборки проекта лежит в определенной папке. Ваша цель - правильно указать параметры, чтобы сборка прошла успешно! Если получится - вы получаете полный балл за задание!

## Задание 4. CI
Есть имеющийся проект на CMake, который даже компилируется. Необходимо настроить CI для этого проекта

#### Предыстория
У нас есть работающий проект, теперь мы хотим пригласить людей в коллабораторы! Необходимо настроить автоматическую сборку проекта через CI

Вашей целью является использовать готовый репозиторий, для которого настроить CI через [Github Actions](https://github.com/features/actions)

#### Сценарий исполнения CI:
- Клонируется репозиторий
- Собирается библиотека (итоги - тоже артефакты сборки)
- Запускаются тесты, результаты тестов записываются в файлик, который является одним из артефактов сборки
- Выкачиваются артефакты сборки проекта

### Алгоритм действия

1. Клонируйте [репозиторий](https://github.com/akhtyamovpavel/TechProgCITemplate) (он собирается под Linux и Mac спокойно). Изучите структуру проекта, выясните, каким образом необходимо подключить googletest.
2. Создайте step Build, в котором укажите, каким образом собирается проект при помощи CMake (важно, установку в этом шаге тоже необходимо прописывать)
3. Создайте step Test при помощи [репозитория](https://github.com/akhtyamovpavel/ActionGtestReport) , используйте версию v0.0.9. На выходе должен появиться архив с названием test-report. Аргументы указаны в action.yml.
4. Создайте step UploadArtifacts, в нем сделайте загрузку папки bin и lib, полученные после make install как отдельного артефакта.

